import numpy as np
import matplotlib.pyplot as plt

# Figure 2, panel A
plt.figure(1)
plt.title("Panel A, p = 2")

expiries = [0.25, 0.5, 1, 2, 3, 4, 5, 7, 10,  15 , 20,  25,  30  ]
vols1 = [0.298953,  0.299422,  0.299633,  0.299836,  0.299782,  0.299858,  0.299912,  0.29982,   0.299933,  0.299917,  0.299818,  0.299932,  0.299837  ]
vols2 = [0.315094,  0.320979,  0.327881,  0.336034,  0.34115,   0.345087,  0.348207,  0.352728,  0.357405,  0.361271,  0.362436,  0.36245,   0.361504 ]
vols3 = [0.32609,   0.335716,  0.347209,  0.360639,  0.368946,  0.375023,  0.379608,  0.385731,  0.390817,  0.393045,  0.391759,  0.389326,  0.386182 ]
vols4 = [0.354366,  0.373722,  0.396909,  0.422808,  0.437504,  0.446862,  0.452849,  0.458632,  0.45976,   0.453763,  0.445212,  0.436815,  0.428868  ]

plt.plot(expiries, vols1, 'k-',  label = 'c=0')
plt.plot(expiries, vols2, 'ob-', label = 'c=3%')
plt.plot(expiries, vols3, '^g-', label = 'c=5%')
plt.plot(expiries, vols4, '+r-', label = 'c=10%')

legend = plt.legend(loc='lower center', shadow=True, fontsize='small')
plt.ylim(.2, .5)
plt.xlim(0., 30.)
plt.xlabel('Option maturity, T (years)')
plt.ylabel('Implied volatility')

plt.grid()
plt.savefig("fig_2_panel_A.png")

# Figure 2, panel B
plt.figure(2)
plt.title("Panel B, c = 5%")

expiries = [0.25, 0.5, 1, 2, 3, 4, 5, 7, 10,  15 , 20,  25,  30  ]
vols1 = [0.329346, 0.341793, 0.358261, 0.380009, 0.395328, 0.407568, 0.417755, 0.434035, 0.45266, 0.474817, 0.491001, 0.504062, 0.515175]
vols2 = [0.328407, 0.339939, 0.354624, 0.372966, 0.385055, 0.39422, 0.40146, 0.412156, 0.423045, 0.433453, 0.438816, 0.441607, 0.442584]
vols3 = [0.32609, 0.335716, 0.347209, 0.360639, 0.368946, 0.375023, 0.379608, 0.385731, 0.390817, 0.393045, 0.391759, 0.389326, 0.386182]

plt.plot(expiries, vols1, '+r-', label = 'p=0')
plt.plot(expiries, vols2, 'ob-', label = 'p=1/2')
plt.plot(expiries, vols3, '^g-', label = 'p=2')

legend = plt.legend(loc='lower center', shadow=True, fontsize='small')
plt.ylim(.25, .55)
plt.xlim(0., 30.)
plt.xlabel('Option maturity, T (years)')
plt.ylabel('Implied volatility')

plt.grid()
plt.savefig("fig_2_panel_B.png")

# Figure 3, panel A
plt.figure(3)
plt.title("Panel A, T = 0.5")

moneynesses = [0.6, 0.7, 0.8, 0.9, 1, 1.1, 1.2, 1.3, 1.4, 1.5 ]
vols1 = [0.466032, 0.385233, 0.341766, 0.322486, 0.313718, 0.309462, 0.307205, 0.306164, 0.305627, 0.305543 ]
vols2 = [0.574747, 0.469502, 0.397063, 0.356571, 0.335716, 0.324748, 0.318546, 0.315024, 0.312824, 0.311571 ]
vols3 = [0.699762, 0.576714, 0.478693, 0.412741, 0.373722, 0.351497, 0.338386, 0.330459, 0.325301, 0.321973 ]

plt.plot(moneynesses, vols1, '+k-', label = 'c=2%')
plt.plot(moneynesses, vols2, 'ob-', label = 'c=5%')
plt.plot(moneynesses, vols3, '^g-', label = 'c=10%')

legend = plt.legend(loc='upper right', shadow=True, fontsize='small')
plt.ylim(.25, .75)
plt.xlim(0.55, 1.55)
plt.xlabel('Strike (% of forward)')
plt.ylabel('Implied volatility')

plt.grid()
plt.savefig("fig_3_panel_A.png")


# Figure 3, panel B
plt.figure(4)
plt.title("Panel B, T = 5")

moneynesses = [0.6, 0.7, 0.8, 0.9, 1, 1.1, 1.2, 1.3, 1.4, 1.5 ]
vols1 = [0.375463, 0.358324, 0.346468, 0.338187, 0.332204, 0.327587, 0.324023, 0.321261, 0.319123, 0.317383 ]
vols2 = [0.466252, 0.434929, 0.411173, 0.393263, 0.379608, 0.368874, 0.360397, 0.353651, 0.348253, 0.343809 ]
vols3 = [0.577991, 0.537242, 0.503293, 0.475485, 0.452849, 0.434264, 0.419029, 0.406516, 0.396208, 0.387578 ]

plt.plot(moneynesses, vols1, '+k-', label = 'c=2%')
plt.plot(moneynesses, vols2, 'ob-', label = 'c=5%')
plt.plot(moneynesses, vols3, '^g-', label = 'c=10%')

legend = plt.legend(loc='upper right', shadow=True, fontsize='small')
plt.ylim(.25, .6)
plt.xlim(0.55, 1.55)
plt.xlabel('Strike (% of forward)')
plt.ylabel('Implied volatility')

plt.grid()
plt.savefig("fig_3_panel_B.png")

# Figure 4
plt.figure(5)

moneynesses = [0.6, 0.7, 0.8, 0.9, 1, 1.1, 1.2, 1.3, 1.4, 1.5 ]
vols1 = [0.508949, 0.444747, 0.402117, 0.375254, 0.358261, 0.347307, 0.339799, 0.334552, 0.330683, 0.327848 ]
vols2 = [0.511976, 0.442016, 0.394826, 0.365368, 0.347209, 0.335873, 0.328354, 0.323268, 0.319629, 0.317051 ]

plt.plot(moneynesses, vols1, '+k-', label = 'p=0')
plt.plot(moneynesses, vols2, 'ob-', label = 'p=2')

legend = plt.legend(loc='upper right', shadow=True, fontsize='small')
plt.ylim(.3, .55)
plt.xlim(0.55, 1.55)
plt.xlabel('Strike (% of forward)')
plt.ylabel('Implied volatility')

plt.grid()
plt.savefig("fig_4.png")


# Figure 5, panel A
plt.figure(6)
plt.title("Panel A, p = 2")

expiries = [0.25, 0.5, 1, 2, 3, 4, 5, 7, 10,  15 , 20,  25,  30  ]
vols1 = [0.0204762, 0.0209529, 0.0218993, 0.0237012, 0.0252822, 0.0265834, 0.0276058, 0.0289493, 0.0297788, 0.0296364, 0.0287963, 0.0277764, 0.0267505 ]
vols2 = [0.0507761, 0.0514984, 0.0527421, 0.0543924, 0.055074, 0.0550737, 0.0546402, 0.0531043, 0.050268, 0.0457708, 0.0420359, 0.0389844, 0.0364622 ]
vols3 = [0.100192, 0.100218, 0.0996805, 0.0969985, 0.0933325, 0.0894644, 0.0857223, 0.079002, 0.0708598, 0.0610573, 0.0541758, 0.0490496, 0.0450583 ]

plt.plot(expiries, vols1, 'ob-', label = 'c=2%')
plt.plot(expiries, vols2, '^g-', label = 'c=5%')
plt.plot(expiries, vols3, '+r-', label = 'c=10%')

legend = plt.legend(loc='lower center', shadow=True, fontsize='small')
plt.ylim(0, .12)
plt.xlim(0., 30.)
plt.xlabel('Bond maturity, T (years)')
plt.ylabel('Risky spread, s')

plt.grid()
plt.savefig("fig_5_panel_A.png")

# Figure 5, panel B
plt.figure(7)
plt.title("Panel B, c = 5%")

expiries = [0.25, 0.5, 1, 2, 3, 4, 5, 7, 10,  15 , 20,  25,  30  ]
vols1 = [0.0499723, 0.0499728, 0.0499729, 0.0499729, 0.0499729, 0.0499729, 0.0499729, 0.0499729, 0.0499729, 0.0499728, 0.0499728, 0.0499727, 0.0499726 ]
vols2 = [0.0507761, 0.0514984, 0.0527421, 0.0543924, 0.055074, 0.0550737, 0.0546402, 0.0531043, 0.050268, 0.0457708, 0.0420359, 0.0389844, 0.0364622 ]
vols3 = [0.0520171, 0.0538322, 0.0567695, 0.0598742, 0.0604903, 0.0598745, 0.0587001, 0.0558203, 0.0515766, 0.0458271, 0.0415035, 0.0381584, 0.0354868 ]

plt.plot(expiries, vols1, '+r-', label = 'p=0')
plt.plot(expiries, vols2, 'ob-', label = 'p=2')
plt.plot(expiries, vols3, '^g-', label = 'p=3')

legend = plt.legend(loc='lower center', shadow=True, fontsize='small')
plt.ylim(.03, .07)
plt.xlim(0., 30.)
plt.xlabel('Bond maturity, T (years)')
plt.ylabel('Risky spread, s')

plt.grid()
plt.savefig("fig_5_panel_B.png")


# Figure 6
plt.figure(8)

expiries = [0.25, 0.5, 1, 2, 3, 4, 5, 7, 10,  15 , 20,  25,  30  ]
vols1 = [0.0977648, 0.0957332, 0.0918934, 0.0850622, 0.0792179, 0.0741862, 0.0698168, 0.0626059, 0.0544538, 0.0450907, 0.0387056, 0.0340313, 0.0304399 ]
vols2 = [0.100192, 0.100218, 0.0996805, 0.0969985, 0.0933325, 0.0894644, 0.0857223, 0.079002, 0.0708598, 0.0610573, 0.0541758, 0.0490496, 0.0450583 ]
vols3 = [0.106237, 0.111713, 0.119969, 0.127103, 0.127481, 0.125234, 0.122057, 0.115254, 0.106155, 0.0946601, 0.0863993, 0.080171, 0.075281 ]

plt.plot(expiries, vols1, '+r-', label = 'sigma=15%')
plt.plot(expiries, vols2, 'ob-', label = 'sigma=30%')
plt.plot(expiries, vols3, '^g-', label = 'sigma=50%')

legend = plt.legend(loc='lower center', shadow=True, fontsize='small')
plt.ylim(.0, .14)
plt.xlim(0., 30.)
plt.xlabel('Bond maturity, T (years)')
plt.ylabel('Risky spread, s')

plt.grid()
plt.savefig("fig_6.png")


# Figure 7, panel A
plt.figure(9)
plt.title("Panel A: a(t)")

expiries = [0.0833333, 0.166667, 0.25, 0.333333, 0.416667, 0.5, 0.583333, 0.666667, 0.75, 0.833333, 0.916667, 1, 1.08333, 1.16667, 1.25, 1.33333, 1.41667, 1.5, 1.58333, 1.66667, 1.75, 1.83333, 1.91667, 2, 2.08333, 2.16667, 2.25, 2.33333, 2.41667, 2.5, 2.58333, 2.66667, 2.75, 2.83333, 2.91667, 3, 3.08333, 3.16667, 3.25, 3.33333, 3.41667, 3.5, 3.58333, 3.66667, 3.75, 3.83333, 3.91667, 4, 4.08333, 4.16667, 4.25, 4.33333, 4.41667, 4.5, 4.58333, 4.66667, 4.75, 4.83333, 4.91667, 5, 5.08333, 5.16667, 5.25, 5.33333, 5.41667, 5.5, 5.58333, 5.66667, 5.75, 5.83333, 5.91667, 6, 6.08333, 6.16667, 6.25, 6.33333, 6.41667, 6.5, 6.58333, 6.66667, 6.75, 6.83333, 6.91667, 7, 7.08333, 7.16667, 7.25, 7.33333, 7.41667, 7.5, 7.58333, 7.66667, 7.75, 7.83333, 7.91667, 8, 8.08333, 8.16667, 8.25, 8.33333, 8.41667, 8.5, 8.58333, 8.66667, 8.75, 8.83333, 8.91667, 9, 9.08333, 9.16667, 9.25, 9.33333, 9.41667, 9.5, 9.58333, 9.66667, 9.75, 9.83333, 9.91667, 10 ]
a1 = [0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281, 0.0500281 ]
a2 = [0.0499653, 0.0498793, 0.0498227, 0.0497741, 0.0497323, 0.0496965, 0.0496659, 0.04964, 0.0496184, 0.0496007, 0.0495868, 0.0495762, 0.0495689, 0.0495646, 0.0495633, 0.0495647, 0.0495687, 0.0495752, 0.0495842, 0.0495954, 0.049609, 0.0496247, 0.0496425, 0.0496624, 0.0496842, 0.049708, 0.0497336, 0.0497611, 0.0497904, 0.0498214, 0.0498541, 0.0498885, 0.0499245, 0.0499621, 0.0500013, 0.050042, 0.0500843, 0.050128, 0.0501732, 0.0502199, 0.050268, 0.0503174, 0.0503683, 0.0504205, 0.0504741, 0.0505302, 0.0505901, 0.0506524, 0.050716, 0.0507809, 0.050847, 0.0509144, 0.0509831, 0.0510529, 0.051124, 0.0511962, 0.0512697, 0.0513444, 0.0514202, 0.0514972, 0.0515753, 0.0516546, 0.0517351, 0.0518167, 0.0518994, 0.0519833, 0.0520683, 0.0521544, 0.0522416, 0.0523299, 0.0524194, 0.0525099, 0.0526015, 0.0526942, 0.0527881, 0.052883, 0.052979, 0.053076, 0.0531742, 0.0532734, 0.0533737, 0.0534751, 0.0535776, 0.0536811, 0.0537858, 0.0538915, 0.0539982, 0.0541061, 0.054215, 0.054325, 0.054436, 0.0545508, 0.054669, 0.0547885, 0.0549091, 0.0550308, 0.0551535, 0.0552774, 0.0554023, 0.0555284, 0.0556555, 0.0557838, 0.0559131, 0.0560436, 0.0561752, 0.0563078, 0.0564417, 0.0565766, 0.0567126, 0.0568498, 0.0569882, 0.0571276, 0.0572682, 0.05741, 0.0575529, 0.057697, 0.0578423, 0.0579887, 0.0581363, 0.0582851 ]
a3 = [0.0498079, 0.0494834, 0.0492384, 0.0490154, 0.0488114, 0.048624, 0.048451, 0.0482912, 0.0481432, 0.0480063, 0.0478794, 0.0477621, 0.0476536, 0.0475536, 0.0474616, 0.0473771, 0.0472998, 0.0472295, 0.0471658, 0.0471084, 0.0470572, 0.0470118, 0.0469722, 0.0469381, 0.0469093, 0.0468857, 0.0468672, 0.0468535, 0.0468446, 0.0468403, 0.0468406, 0.0468452, 0.0468542, 0.0468674, 0.0468846, 0.046906, 0.0469312, 0.0469604, 0.0469933, 0.0470299, 0.0470702, 0.0471141, 0.0471616, 0.0472125, 0.0472668, 0.0473275, 0.0473976, 0.0474738, 0.0475532, 0.0476358, 0.0477215, 0.0478103, 0.0479022, 0.0479971, 0.0480949, 0.0481957, 0.0482995, 0.0484061, 0.0485157, 0.0486281, 0.0487433, 0.0488613, 0.0489822, 0.0491058, 0.0492322, 0.0493613, 0.0494932, 0.0496278, 0.0497651, 0.0499051, 0.0500478, 0.0501932, 0.0503412, 0.0504919, 0.0506453, 0.0508013, 0.0509599, 0.0511212, 0.0512852, 0.0514518, 0.051621, 0.0517928, 0.0519673, 0.0521445, 0.0523242, 0.0525067, 0.0526917, 0.0528794, 0.0530698, 0.0532629, 0.0534586, 0.0536637, 0.0538779, 0.0540953, 0.0543154, 0.0545382, 0.0547638, 0.0549921, 0.0552232, 0.0554571, 0.0556938, 0.0559333, 0.0561757, 0.0564209, 0.0566691, 0.0569201, 0.057174, 0.0574309, 0.0576907, 0.0579535, 0.0582193, 0.0584882, 0.0587601, 0.0590351, 0.0593131, 0.0595943, 0.0598787, 0.0601662, 0.060457, 0.060751 ]
a4 = [0.0492101, 0.047975, 0.0469947, 0.0460968, 0.0452707, 0.0445071, 0.0437992, 0.0431415, 0.0425295, 0.0419593, 0.0414278, 0.040932, 0.0404695, 0.040038, 0.0396353, 0.0392598, 0.0389096, 0.0385833, 0.0382794, 0.0379967, 0.0377338, 0.0374897, 0.0372635, 0.037054, 0.0368606, 0.0366823, 0.0365184, 0.0363682, 0.0362311, 0.0361065, 0.0359938, 0.0358925, 0.0358021, 0.0357222, 0.0356523, 0.0355921, 0.0355412, 0.0354993, 0.035466, 0.0354411, 0.0354242, 0.0354152, 0.0354137, 0.0354197, 0.0354327, 0.0354595, 0.0355062, 0.0355656, 0.0356308, 0.0357019, 0.0357786, 0.035861, 0.035949, 0.0360425, 0.0361415, 0.0362458, 0.0363555, 0.0364704, 0.0365905, 0.0367158, 0.0368462, 0.0369818, 0.0371223, 0.0372679, 0.0374185, 0.037574, 0.0377344, 0.0378998, 0.03807, 0.0382451, 0.0384251, 0.03861, 0.0387997, 0.0389943, 0.0391937, 0.0393979, 0.039607, 0.039821, 0.0400398, 0.0402635, 0.0404921, 0.0407256, 0.040964, 0.0412074, 0.0414558, 0.0417091, 0.0419675, 0.0422309, 0.0424994, 0.042773, 0.0430518, 0.0433522, 0.0436725, 0.0439988, 0.0443301, 0.0446664, 0.0450079, 0.0453547, 0.045707, 0.0460648, 0.0464283, 0.0467975, 0.0471725, 0.0475534, 0.0479404, 0.0483335, 0.0487328, 0.0491385, 0.0495505, 0.0499691, 0.0503943, 0.0508262, 0.0512649, 0.0517106, 0.0521632, 0.052623, 0.0530901, 0.0535645, 0.0540464, 0.0545359 ]

plt.plot(expiries, a1, 'k-', label = 'p=0')
plt.plot(expiries, a2, 'b-', label = 'p=0.5')
plt.plot(expiries, a3, 'g-', label = 'p=1')
plt.plot(expiries, a4, 'r-', label = 'p=2')

legend = plt.legend(loc='lower left', shadow=True, fontsize='small')
plt.ylim(0, .07)
plt.xlim(0., 10)
plt.xlabel('t (years)')
plt.ylabel('Spread function, a(t)')

plt.grid()
plt.savefig("fig_7_panel_A.png")

# Figure 7, panel A
plt.figure(10)
plt.title("Panel B: b(t)")

expiries = [0.0833333, 0.166667, 0.25, 0.333333, 0.416667, 0.5, 0.583333, 0.666667, 0.75, 0.833333, 0.916667, 1, 1.08333, 1.16667, 1.25, 1.33333, 1.41667, 1.5, 1.58333, 1.66667, 1.75, 1.83333, 1.91667, 2, 2.08333, 2.16667, 2.25, 2.33333, 2.41667, 2.5, 2.58333, 2.66667, 2.75, 2.83333, 2.91667, 3, 3.08333, 3.16667, 3.25, 3.33333, 3.41667, 3.5, 3.58333, 3.66667, 3.75, 3.83333, 3.91667, 4, 4.08333, 4.16667, 4.25, 4.33333, 4.41667, 4.5, 4.58333, 4.66667, 4.75, 4.83333, 4.91667, 5, 5.08333, 5.16667, 5.25, 5.33333, 5.41667, 5.5, 5.58333, 5.66667, 5.75, 5.83333, 5.91667, 6, 6.08333, 6.16667, 6.25, 6.33333, 6.41667, 6.5, 6.58333, 6.66667, 6.75, 6.83333, 6.91667, 7, 7.08333, 7.16667, 7.25, 7.33333, 7.41667, 7.5, 7.58333, 7.66667, 7.75, 7.83333, 7.91667, 8, 8.08333, 8.16667, 8.25, 8.33333, 8.41667, 8.5, 8.58333, 8.66667, 8.75, 8.83333, 8.91667, 9, 9.08333, 9.16667, 9.25, 9.33333, 9.41667, 9.5, 9.58333, 9.66667, 9.75, 9.83333, 9.91667, 10 ]
a1 = [0.409284, 0.364272, 0.356736, 0.35003, 0.344172, 0.338961, 0.334241, 0.329904, 0.325878, 0.322108, 0.318552, 0.315182, 0.311971, 0.3089, 0.305953, 0.303116, 0.300379, 0.297732, 0.295166, 0.292674, 0.290251, 0.28789, 0.285587, 0.283338, 0.281139, 0.278985, 0.276875, 0.274805, 0.272773, 0.270777, 0.268813, 0.266881, 0.264978, 0.263103, 0.261254, 0.25943, 0.257629, 0.25585, 0.254092, 0.252354, 0.250635, 0.248933, 0.247247, 0.245578, 0.243923, 0.239358, 0.234261, 0.232616, 0.230983, 0.229362, 0.227751, 0.226152, 0.224562, 0.222981, 0.221409, 0.219845, 0.218288, 0.216738, 0.215195, 0.213658, 0.212126, 0.2106, 0.209078, 0.20756, 0.206045, 0.204534, 0.203026, 0.20152, 0.200016, 0.198513, 0.197011, 0.195511, 0.19401, 0.192509, 0.191008, 0.189505, 0.188001, 0.186496, 0.184988, 0.183477, 0.181963, 0.180446, 0.178925, 0.177399, 0.175868, 0.174332, 0.17279, 0.171241, 0.169686, 0.168123, 0.166552, 0.156206, 0.153828, 0.152157, 0.150475, 0.14878, 0.147072, 0.14535, 0.143613, 0.14186, 0.140091, 0.138304, 0.136498, 0.134673, 0.132826, 0.130958, 0.129066, 0.127149, 0.125206, 0.123235, 0.121234, 0.119202, 0.117136, 0.115034, 0.112894, 0.110713, 0.108488, 0.106217, 0.103895, 0.10152 ]
a2 = [0.409676, 0.365566, 0.358817, 0.352887, 0.347797, 0.343346, 0.33938, 0.335791, 0.332507, 0.329472, 0.326648, 0.324003, 0.321514, 0.31916, 0.316925, 0.314798, 0.312765, 0.310819, 0.308951, 0.307153, 0.305421, 0.303748, 0.30213, 0.300562, 0.299041, 0.297564, 0.296128, 0.294729, 0.293366, 0.292036, 0.290737, 0.289467, 0.288224, 0.287007, 0.285814, 0.284645, 0.283497, 0.282369, 0.28126, 0.28017, 0.279098, 0.278041, 0.277, 0.275974, 0.274962, 0.271374, 0.267332, 0.266324, 0.265329, 0.264344, 0.26337, 0.262406, 0.261451, 0.260506, 0.259568, 0.258639, 0.257718, 0.256803, 0.255895, 0.254994, 0.254098, 0.253209, 0.252324, 0.251444, 0.250569, 0.249698, 0.248831, 0.247968, 0.247108, 0.246251, 0.245397, 0.244545, 0.243695, 0.242848, 0.242002, 0.241158, 0.240314, 0.239472, 0.238631, 0.237789, 0.236949, 0.236108, 0.235267, 0.234425, 0.233583, 0.23274, 0.231896, 0.23105, 0.230203, 0.229354, 0.228503, 0.221364, 0.219964, 0.219067, 0.218168, 0.217265, 0.216359, 0.215449, 0.214535, 0.213618, 0.212696, 0.21177, 0.210839, 0.209903, 0.208961, 0.208014, 0.207061, 0.206102, 0.205137, 0.204165, 0.203186, 0.202199, 0.201206, 0.200204, 0.199194, 0.198176, 0.197148, 0.196112, 0.195066, 0.19401 ]
a3 = [0.410068, 0.366852, 0.360874, 0.355696, 0.351343, 0.347616, 0.34436, 0.341469, 0.338869, 0.336509, 0.334348, 0.332355, 0.330507, 0.328785, 0.327174, 0.325659, 0.324231, 0.32288, 0.321599, 0.32038, 0.319219, 0.318108, 0.317046, 0.316026, 0.315046, 0.314103, 0.313193, 0.312315, 0.311465, 0.310642, 0.309844, 0.309068, 0.308315, 0.307581, 0.306866, 0.306169, 0.305487, 0.304821, 0.304169, 0.303531, 0.302905, 0.302291, 0.301687, 0.301094, 0.30051, 0.297568, 0.294214, 0.293617, 0.293027, 0.292445, 0.29187, 0.291301, 0.290738, 0.29018, 0.289627, 0.289079, 0.288536, 0.287997, 0.287461, 0.286929, 0.2864, 0.285875, 0.285351, 0.284831, 0.284312, 0.283795, 0.28328, 0.282767, 0.282255, 0.281744, 0.281233, 0.280724, 0.280215, 0.279706, 0.279197, 0.278689, 0.27818, 0.277671, 0.277161, 0.276651, 0.27614, 0.275628, 0.275115, 0.2746, 0.274084, 0.273567, 0.273048, 0.272526, 0.272003, 0.271478, 0.270951, 0.265141, 0.264143, 0.263564, 0.262983, 0.262398, 0.26181, 0.26122, 0.260626, 0.260028, 0.259427, 0.258822, 0.258213, 0.2576, 0.256983, 0.256361, 0.255735, 0.255105, 0.254469, 0.253829, 0.253184, 0.252533, 0.251877, 0.251215, 0.250547, 0.249874, 0.249194, 0.248508, 0.247815, 0.247116 ]
a4 = [0.410855, 0.369387, 0.364876, 0.361093, 0.358076, 0.355625, 0.35359, 0.351869, 0.35039, 0.349103, 0.347971, 0.346965, 0.346065, 0.345252, 0.344513, 0.343837, 0.343215, 0.342639, 0.342103, 0.341602, 0.341131, 0.340686, 0.340265, 0.339863, 0.33948, 0.339113, 0.338759, 0.338418, 0.338088, 0.337768, 0.337457, 0.337153, 0.336856, 0.336565, 0.33628, 0.335999, 0.335723, 0.33545, 0.335181, 0.334914, 0.334651, 0.334389, 0.334129, 0.333871, 0.333615, 0.331227, 0.328463, 0.328164, 0.327866, 0.327568, 0.327271, 0.326974, 0.326678, 0.326381, 0.326085, 0.325788, 0.325492, 0.325195, 0.324897, 0.324599, 0.3243, 0.324001, 0.323701, 0.3234, 0.323099, 0.322796, 0.322492, 0.322188, 0.321882, 0.321575, 0.321266, 0.320957, 0.320646, 0.320333, 0.320019, 0.319704, 0.319387, 0.319068, 0.318748, 0.318426, 0.318102, 0.317776, 0.317449, 0.317119, 0.316788, 0.316454, 0.316118, 0.315781, 0.31544, 0.315098, 0.314754, 0.309868, 0.309106, 0.308702, 0.308295, 0.307885, 0.307472, 0.307057, 0.306638, 0.306217, 0.305792, 0.305364, 0.304933, 0.304498, 0.304061, 0.30362, 0.303175, 0.302727, 0.302275, 0.30182, 0.301361, 0.300898, 0.300431, 0.299961, 0.299486, 0.299007, 0.298524, 0.298037, 0.297545, 0.297049 ]

plt.plot(expiries, a1, 'k-', label = 'p=0')
plt.plot(expiries, a2, 'b-', label = 'p=0.5')
plt.plot(expiries, a3, 'g-', label = 'p=1')
plt.plot(expiries, a4, 'r-', label = 'p=2')

legend = plt.legend(loc='lower left', shadow=True, fontsize='small')
plt.ylim(0.05, .45)
plt.xlim(0., 10)
plt.xlabel('t (years)')
plt.ylabel('Volatility function, b(t)')

plt.grid()
plt.savefig("fig_7_panel_B.png")
